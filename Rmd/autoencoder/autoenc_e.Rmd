## Autoencoder (Encode) — Visão Geral

Este exemplo demonstra como treinar um autoencoder “vanilla” para aprender uma representação latente (codificação) de uma janela deslizante de uma série temporal. A ideia é reduzir a dimensão de p atributos para k, preservando a informação relevante. Você pode usar os vetores codificados como insumo para outras tarefas (como clustering ou predição).

Pré‑requisitos
- Reticulate configurado e Python com PyTorch instalado
- pacotes R: daltoolbox, tspredit, daltoolboxdp, ggplot2

Passo a passo
1) Preparar o dataset (janelas da série)
2) Normalizar dados (evita escala desbalanceada)
3) Separar treino e teste
4) Treinar o autoencoder (redução de 5 para 3 dimensões)
5) Avaliar perdas e transformar dados em códigos latentes

```{r}
# Vanilla autoencoder transformation (encode)

# Considering a dataset with $p$ numerical attributes. 

# The goal of the autoencoder is to reduce the dimension of $p$ to $k$, such that these $k$ attributes are enough to recompose the original $p$ attributes. 

# installing packages

#install.packages("tspredit")
#install.packages("daltoolboxdp")
```

```{r}
# Carregando pacotes necessários
library(daltoolbox)
library(tspredit)
library(daltoolboxdp)
library(ggplot2)
```

```{r}
# Dataset de exemplo (série temporal e janelas)

data(tsd)

sw_size <- 5
ts <- ts_data(tsd$y, sw_size)

ts_head(ts)
```

```{r}
# Normalização (min-max por grupo) para estabilizar o treino

preproc <- ts_norm_gminmax()
preproc <- fit(preproc, ts)
ts <- transform(preproc, ts)

ts_head(ts)
```

```{r}
# Divisão treino / teste

samp <- ts_sample(ts, test_size = 10)
train <- as.data.frame(samp$train)
test <- as.data.frame(samp$test)
```

```{r}
# Criando e treinando o autoencoder (reduz de 5 para 3 dimensões)

auto <- autoenc_e(5, 3)

auto <- fit(auto, train)
```

```{r}
# Visualizando curvas de perda (treino/validação)
fit_loss <- data.frame(x=1:length(auto$train_loss), train_loss=auto$train_loss,val_loss=auto$val_loss)

grf <- plot_series(fit_loss, colors=c('Blue','Orange'))
plot(grf)
```

```{r}
# Testando o autoencoder: codificando exemplos de teste

print(head(test))
result <- transform(auto, test)
print(head(result))
```
