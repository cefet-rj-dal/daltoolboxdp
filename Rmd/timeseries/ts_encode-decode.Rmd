## Codificação e Reconstrução de Séries (encode-decode)

Este exemplo mostra como transformar uma série temporal em janelas (p) e treinar um autoencoder para codificar (p → k) e reconstruir (k → p) essas janelas, permitindo avaliar a qualidade da reconstrução.

Pré‑requisitos
- pacotes R: daltoolbox, ggplot2
- Python com PyTorch acessível via reticulate (backend chamado internamente)

```{r}
# Carregando pacotes necessários
library(daltoolbox)
```

## Série para estudo

```{r}
data(tsd)
tsd$y[39] <- tsd$y[39] * 6   # injeta um outlier sintético para ilustração
```

```{r}
sw_size <- 5                         # tamanho da janela deslizante (p)
ts <- ts_data(tsd$y, sw_size)        # série → janelas com p colunas
ts_head(ts, 3)
```

```{r}
library(ggplot2)
plot_ts(x = tsd$x, y = tsd$y) +
  theme(text = element_text(size = 16))
```

## Amostragem dos dados

```{r}
samp <- ts_sample(ts, test_size = 5)
train <- as.data.frame(samp$train)
test  <- as.data.frame(samp$test)
```

## Treinando o modelo (encode-decode)

```{r}
auto <- autoenc_ed(5, 3)             # 5 → 3 → 5 dimensões
auto <- fit(auto, train)
```

## Avaliação da reconstrução (treino)

```{r}
print(head(train))                    # janelas originais (p colunas)
result <- transform(auto, train)      # janelas reconstruídas (p colunas)
print(head(result))
```

## Reconstrução do conjunto de teste

```{r}
print(head(test))
result <- transform(auto, test)
print(head(result))
```

